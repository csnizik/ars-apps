parameters:
  level: 6

  # Directories to scan
  paths:
    - web/modules/custom
    - web/themes/custom

  # Improve type safety only where it matters
  checkMissingIterableValueType: true
  checkMissingCallableSignature: true

  # Don't be overly strict on PHPDoc-derived types
  treatPhpDocTypesAsCertain: true
  checkGenericClassInNonGenericObjectType: false

  # Optional: if you're using Symfony container types
  # containerClass: Drupal\Core\DependencyInjection\Container

  # Ignore low-value errors
  ignoreErrors:
    # Theme preprocess and *.theme edge cases
    - '#Function .* has parameter \$(variables|suggestions) with no value type specified in iterable type array#'
    - '#PHPDoc tag @var above a function has no effect#'
    - '#PHPDoc tag @var for variable \$variables has no value type specified in iterable type array#'

    # Drupal Form API inconsistencies
    - '#Parameter .*\$form (by-ref|@param-out) type of method .*submitForm.* expects array<string, mixed>, array given#'
    - '#Function .* has parameter \$form with no value type specified in iterable type array#'

    # PHPUnit "always true" assertions in test files
    - '#Call to method PHPUnit\\Framework\\Assert::assert.* will always evaluate to true#'
      paths:
        - web/modules/custom/*/tests/src/Unit/*
        - web/modules/custom/*/tests/src/Functional/*
        - web/themes/custom/*/tests/src/*

  # Optional: silence common "unknown class/interface" in legacy code if needed
  # stubFiles:
  #   - phpstan-drupal/stubs

includes:
  - vendor/mglaman/phpstan-drupal/extension.neon
